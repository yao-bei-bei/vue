webpackJsonp([6],{ENOt:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("//Fk"),r=n.n(o),s=n("Dd8w"),i=n.n(s),a=n("7+uW"),u={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var c=n("VU/8")({name:"app"},u,!1,function(e){n("pj9E")},null,null).exports,l=n("/ocq"),m={name:"HelloWorld",data:function(){return{}},created:function(){var e=this;setTimeout(function(){alert("欢迎"),e.$router.push({path:"/login",query:{page:1,size:10,box:1}})},2e3)}},f={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"hello"},[this._v("\n欢迎页\n  ")])},staticRenderFns:[]};var p=n("VU/8")(m,f,!1,function(e){n("xjXQ")},"data-v-7aa9c64c",null).exports,d={name:"login",data:function(){return{loginfrom:{username:"",pew:"123456"},iSshow:!0}},created:function(){var e=this;console.log(this),console.log(e),setTimeout(function(){alert("欢迎"),e.iSshow=!1},1e3)},methods:{submituUserInfo:function(e){var t=this;console.log(e),this.$store.dispatch("Logins",e).then(function(e){console.log(e),console.log(t.$store.state.login.username),sessionStorage.getItem("access_token")?t.$router.push({path:"/list",query:{username:e.username}}):alert("access_token不存在")}).catch(function(){})}}},h={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),e._v(" "),n("el-form",{staticClass:"login_box",attrs:{"label-position":"right","label-width":"60px",model:e.loginfrom}},[n("el-form-item",{attrs:{label:"用户名"}},[n("el-input",{model:{value:e.loginfrom.username,callback:function(t){e.$set(e.loginfrom,"username",t)},expression:"loginfrom.username"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"密码"}},[n("el-input",{attrs:{type:"password"},model:{value:e.loginfrom.pew,callback:function(t){e.$set(e.loginfrom,"pew",t)},expression:"loginfrom.pew"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submituUserInfo(e.loginfrom)}}},[e._v("登录")])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[this._v("\n    管理员(A) :admin"),t("br"),this._v("\n    管理员(B)：admin1"),t("br"),this._v("\n    管理员(C)：admin2"),t("br")])}]};var g=n("VU/8")(d,h,!1,function(e){n("ENOt")},"data-v-698acff7",null).exports;a.default.use(l.a);var v=new l.a({routes:[{path:"/",name:"HelloWorld",redirect:"/login",component:p,meta:{requireAuth:!1}},{path:"/login",name:"Login",component:g,meta:{requireAuth:!1}}]}),E=[{path:"/list",meta:{requireAuth:!0},name:"list",redirect:"/list/A",hidden:!1,component:function(e){return n.e(3).then(function(){var t=[n("pjeT")];e.apply(null,t)}.bind(this)).catch(n.oe)},children:[{path:"/list/A",name:"A",component:function(e){return n.e(2).then(function(){var t=[n("G2es")];e.apply(null,t)}.bind(this)).catch(n.oe)}},{path:"/list/B",name:"B",component:function(e){return n.e(0).then(function(){var t=[n("cKLF")];e.apply(null,t)}.bind(this)).catch(n.oe)},meta:{role:"B"}},{path:"/list/C",name:"C",component:function(e){return n.e(1).then(function(){var t=[n("wR7Y")];e.apply(null,t)}.bind(this)).catch(n.oe)},meta:{role:"C"}},{path:"/list/D",name:"D",component:function(e){return n.e(4).then(function(){var t=[n("tWP8")];e.apply(null,t)}.bind(this)).catch(n.oe)}}]}],_=(n("j1ja"),n("NYxO")),S=[{id:1,username:"admin",pew:123456,role:"A",introduce:"我可以看见全部页面"},{id:2,username:"admin1",pew:123456,role:"B",introduce:"我可以看到red和yellow页面"},{id:3,username:"admin2",pew:123456,role:"C",introduce:"我可以看见red和blue页面"}],w={state:{username:sessionStorage.getItem("USERNAME"),role:sessionStorage.getItem("ROLE"),introduce:"",newrouter:[],todos:[{id:1,text:"...",done:!0},{id:2,text:"...",done:!1}]},getters:{doneTodos:function(e){return e.todos.filter(function(e){return e.done})}},mutations:{SET_USERNAME:function(e,t){e.username=t},SET_ROLE:function(e,t){e.role=t},SET_INTRODUCE:function(e,t){e.introduce=t},SET_NEWROUER:function(e,t){e.newrouter=t}},actions:{Logins:function(e,t){var n=e.commit;return new r.a(function(e,o){var r={box:"登录失败"};S.map(function(e){if(t.username===e.username||t.pew===e.pew){n("SET_USERNAME",e.username),sessionStorage.setItem("USERNAME",e.username),n("SET_ROLE",e.role),sessionStorage.setItem("ROLE",e.role);return sessionStorage.setItem("access_token","111"),r={username:e.username,introduce:e.introduce,box:"登录成功"}}return r}),e(r)}).catch(function(e){reject(e)})},Roles:function(e,t){var n=e.commit;return new r.a(function(e,o){n("SET_NEWROUER",t),e(t)}).catch(function(e){reject(e)})},Logout:function(e){var t=e.commit;e.state;return new r.a(function(e,n){t("SET_USERNAME",""),t("SET_ROLE",""),t("SET_NEWROUER",[]),location.reload(),sessionStorage.removeItem("USERNAME"),sessionStorage.removeItem("access_token"),sessionStorage.removeItem("ROLE"),e()}).catch(function(e){reject(e)})}}},R={username:function(e){return e.login.username},role:function(e){return e.login.role},newrouter:function(e){return e.login.newrouter}};a.default.use(_.a);var b=new _.a.Store({modules:{login:w},getters:R}),A=(n("uMhA"),n("zL8q")),x=n.n(A),I=(n("tvR6"),n("mtWM")),O=n.n(I),y=n("f3u+"),k=n.n(y),N=(n("y+mr"),n("POcy")),T=n.n(N);a.default.use(T.a),a.default.use(k.a),a.default.prototype.axios=O.a,a.default.use(x.a),a.default.config.productionTip=!1,console.log("store",b),v.beforeEach(function(e,t,n){if(b.getters.role)if(0!==b.getters.newrouter.length)n();else{var o=void 0;if("A"==b.getters.role)console.log(b.getters.role),o=E;else{var r=E[0].children.filter(function(e){return!e.meta||e.meta.role==b.getters.role});(o=E)[0].children=r}v.addRoutes(o),b.dispatch("Roles",o).then(function(t){n(i()({},e)),sessionStorage.getItem("access_token")?n():(alert("未登录，请跳转登录页进行登录"),n("/login"))}).catch(function(){})}else-1===["/"].indexOf(e.path)?(console.log(-1!==["/login"].indexOf(e.path)),console.log(sessionStorage.getItem("access_token")),-1!==["/login"].indexOf(e.path)?n():(alert("未登录，请跳转登录页进行登录"),n("/login"))):n()}),O.a.interceptors.request.use(function(e){return sessionStorage.getItem("access_token")&&(e.headers.Authorization="token "+sessionStorage.getItem("access_token")),e},function(e){return r.a.reject(e)}),O.a.interceptors.response.use(function(e){return e},function(e){if(e.response){var t=function(){sessionStorage.removeItem("USERNAME"),sessionStorage.removeItem("access_token"),sessionStorage.removeItem("ROLE"),alert("返回错误 清除token信息并跳转到登录页面"),v.replace({path:"/login"})};switch(console.log(e.response),e.response.status){case 404:case 405:t()}}return r.a.reject(e.response)}),new a.default({el:"#app",router:v,store:b,template:"<App/>",components:{App:c}});var U=new a.default;a.default.prototype.bus=U},pj9E:function(e,t){},tvR6:function(e,t){},uMhA:function(e,t){},xjXQ:function(e,t){},"y+mr":function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.3a931544d96bf79f06f9.js.map